// ุงูุญุตูู ุนูู ุนูุงุตุฑ HTML ุงูุฑุฆูุณูุฉ ูู ุงูุตูุญุฉ ุจุงุณุชุฎุฏุงู ูุนุฑูุงุชูุง (IDs)
const stagesContainer = document.getElementById("stages-container"); // ุญุงููุฉ ุงููุฑุงุญู
const quizContainer = document.getElementById("quiz-container");     // ุญุงููุฉ ุงูุงุฎุชุจุงุฑ (ุงูุฃุณุฆูุฉ)
const resultContainer = document.getElementById("result-container"); // ุญุงููุฉ ุงููุชุงุฆุฌ
const quizTitle = document.getElementById("quiz-title");             // ุนููุงู ุงูุงุฎุชุจุงุฑ (ุงุณู ุงููุฑุญูุฉ)
const questionText = document.getElementById("question-text");       // ูุต ุงูุณุคุงู
const optionsContainer = document.getElementById("options-container"); // ุญุงููุฉ ุฎูุงุฑุงุช ุงูุฅุฌุงุจุฉ
const nextButton = document.getElementById("next-button");           // ุฒุฑ ุงูุชุงูู (ูุฎูู ุญุงูููุง)
const backButton = document.getElementById("back-button");           // ุฒุฑ ุงูุนูุฏุฉ
const continueButton = document.getElementById("continue-button");   // ุฒุฑ ุงููุชุงุจุนุฉ ูู ุดุงุดุฉ ุงููุชุงุฆุฌ
const questionCounter = document.getElementById("question-counter"); // ุนุฏุงุฏ ุงูุฃุณุฆูุฉ
const feedbackContainer = document.getElementById("feedback-container"); // ุญุงููุฉ ุงูุชุบุฐูุฉ ุงูุฑุงุฌุนุฉ (ุตุญูุญ/ุฎุทุฃ)
const resultIcon = document.getElementById("result-icon");           // ุฃููููุฉ ุงููุชูุฌุฉ
const resultTitle = document.getElementById("result-title");         // ุนููุงู ุงููุชูุฌุฉ
const resultScore = document.getElementById("result-score");         // ููุงุท ุงููุชูุฌุฉ
const resultMessage = document.getElementById("result-message");     // ุฑุณุงูุฉ ุงููุชูุฌุฉ

// ุชุนุฑูู ุงููุชุบูุฑุงุช ุงูุฃุณุงุณูุฉ ูุญุงูุฉ ุงููุนุจุฉ
let currentStage = 1;         // ุงููุฑุญูุฉ ุงูุญุงููุฉ ุงูุชู ููุนุจูุง ุงููุณุชุฎุฏู (ุชุจุฏุฃ ูู 1)
let currentQuestionIndex = 0; // ููุฑุณ ุงูุณุคุงู ุงูุญุงูู ุฏุงุฎู ุงููุฑุญูุฉ (ูุจุฏุฃ ูู 0)
let correctAnswersCount = 0;  // ุนุฏุฏ ุงูุฅุฌุงุจุงุช ุงูุตุญูุญุฉ ูู ุงููุฑุญูุฉ ุงูุญุงููุฉ
let totalQuestions = 5;       // ุงูุนุฏุฏ ุงูุฅุฌูุงูู ููุฃุณุฆูุฉ ูู ูู ูุฑุญูุฉ

// ุชุนุฑูู ูุงุฆู ูุญุชูู ุนูู ุฃุณุฆูุฉ ูู ูุฑุญูุฉ
const questions = {
    // ุฃุณุฆูุฉ ุงููุฑุญูุฉ ุงูุฃููู (ุณูู)
    1: [
        { question: "ูุง ูู ุงูุงุณู ุงูููููุงุฆู ูููุฑูุจ ุงููุนุฑูู ุจุงุณู 'ููุญ ุงูุทุนุงู'ุ", options: ["ูููุฑูุฏ ุงูุจูุชุงุณููู", "ูุฑุจููุงุช ุงูุตูุฏููู", "ูููุฑูุฏ ุงูุตูุฏููู", "ูุจุฑูุชุงุช ุงููุบููุณููู"], answer: "ูููุฑูุฏ ุงูุตูุฏููู" },
        { question: "ูู ูู ุฃูู ุฑุงุฆุฏ ูุถุงุก ุนุฑุจูุ", options: ["ูุญูุฏ ูุงุฑุณ", "ุณูุทุงู ุจู ุณููุงู ุขู ุณุนูุฏ", "ูุฒุงุน ุงูููุตูุฑู", "ุฃุญูุฏ ุงููุงุดูู"], answer: "ุณูุทุงู ุจู ุณููุงู ุขู ุณุนูุฏ" },
        { question: "ูุง ูู ุงููุฏููุฉ ุงูุชู ูุทูู ุนูููุง ุงุณู 'ูุฏููุฉ ุงูุถุจุงุจ'ุ", options: ["ุจุงุฑูุณ", "ููุฏู", "ุฑููุง", "ุทูููู"], answer: "ููุฏู" },
        { question: "ูุง ูู ุงูุญููุงู ุงูุฐู ูุง ูุณุชุทูุน ุงูููุฒุ", options: ["ุงูููู", "ุงูููุบุฑ", "ุงูุฃุฑูุจ", "ุงูุถูุฏุน"], answer: "ุงูููู" },
        { question: "ูุง ูู ุฃุทูู ููุฑ ูู ุงูุนุงููุ", options: ["ููุฑ ุงูููู", "ููุฑ ุงูุฃูุงุฒูู", "ููุฑ ุงููุงูุบุชุณู", "ููุฑ ุงููุณูุณูุจู"], answer: "ููุฑ ุงูููู" }
    ],
    // ุฃุณุฆูุฉ ุงููุฑุญูุฉ ุงูุซุงููุฉ (ูุชูุณุท)
    2: [
        { question: "ูุง ูู ุงููุธุฑูุฉ ุงูุชู ุชูุณุฑ ุชูุฏุฏ ุงููููุ", options: ["ูุธุฑูุฉ ุงูุงููุฌุงุฑ ุงูุนุธูู", "ูุธุฑูุฉ ุงูุชุทูุฑ", "ูุธุฑูุฉ ุงููุณุจูุฉ", "ูุธุฑูุฉ ุงูุฃูุชุงุฑ"], answer: "ูุธุฑูุฉ ุงูุงููุฌุงุฑ ุงูุนุธูู" },
        { question: "ูู ูู ุงููููุณูู ุงููููุงูู ุงูุฐู ูุนุชุจุฑ ุฃุจุง ุงูุทุจุ", options: ["ุฃููุงุทูู", "ุฃุฑุณุทู", "ุฃุจูุฑุงุท", "ุณูุฑุงุท"], answer: "ุฃุจูุฑุงุท" },
        { question: "ูุง ูู ุงุณู ุงูุนูููุฉ ุงูุชู ูุชู ูููุง ุชุญููู ุงูุบุงุฒ ุฅูู ุณุงุฆูุ", options: ["ุงูุชุจุฎุฑ", "ุงูุชูุซู", "ุงูุงูุตูุงุฑ", "ุงูุชุณุงูู"], answer: "ุงูุชูุซู" },
        { question: "ูุง ูู ุงูุฏููุฉ ุงูุชู ููุฑ ุจูุง ุฎุท ุงูุงุณุชูุงุก ูุฎุท ุบุฑููุชุด ูุนูุงุ", options: ["ุงูุจุฑุงุฒูู", "ุฅูุฏูููุณูุง", "ุงูุฅููุงุฏูุฑ", "ุณุงู ุชููู ูุจุฑููุณูุจู"], answer: "ุณุงู ุชููู ูุจุฑููุณูุจู" },
        { question: "ูุง ูู ุงุณู ุฃุตุบุฑ ูููุจ ูู ุงููุฌููุนุฉ ุงูุดูุณูุฉุ", options: ["ุงููุฑูุฎ", "ุงูุฒูุฑุฉ", "ุนุทุงุฑุฏ", "ุจููุชู"], answer: "ุนุทุงุฑุฏ" }
    ],
    // ุฃุณุฆูุฉ ุงููุฑุญูุฉ ุงูุซุงูุซุฉ (ูุชูุฏู)
    3: [
        { question: "ูุง ูู ุงุณู ุฃูู ุงูุฑุฃุฉ ุชุญุตู ุนูู ุฌุงุฆุฒุฉ ููุจูุ", options: ["ูุงุฑู ููุฑู", "ุฑูุฒุง ุจุงุฑูุณ", "ููููู ูููุฑ", "ุงูุฃู ุชูุฑูุฒุง"], answer: "ูุงุฑู ููุฑู" },
        { question: "ูุง ูู ุงุณู ุงูุบุงุฒ ุงูุฐู ูุดูู ูุนุธู ุงูุบูุงู ุงูุฌูู ููุฃุฑุถุ", options: ["ุงูุฃูุณุฌูู", "ุซุงูู ุฃูุณูุฏ ุงููุฑุจูู", "ุงูููุชุฑูุฌูู", "ุงูุฃุฑุฌูู"], answer: "ุงูููุชุฑูุฌูู" },
        { question: "ูุง ูู ุงุณู ุฃูุฏู ุฌุงูุนุฉ ูู ุงูุนุงููุ", options: ["ุฌุงูุนุฉ ุงูุฃุฒูุฑ", "ุฌุงูุนุฉ ุจูููููุง", "ุฌุงูุนุฉ ุงููุฑูููู", "ุฌุงูุนุฉ ุฃูุณููุฑุฏ"], answer: "ุฌุงูุนุฉ ุงููุฑูููู" },
        { question: "ูุง ูู ุงุณู ุงูุนูููุฉ ุงูุชู ูุชู ูููุง ุชุญููู ุงูุณุงุฆู ุฅูู ุบุงุฒุ", options: ["ุงูุชูุซู", "ุงูุชุจุฎุฑ", "ุงูุงูุตูุงุฑ", "ุงูุชุฌูุฏ"], answer: "ุงูุชุจุฎุฑ" },
        { question: "ูุง ูู ุงุณู ุงููุถูู ุงูุฐู ููุตู ุจูู ูุงุฑุชู ุขุณูุง ูุฃูุฑูููุงุ", options: ["ูุถูู ุฌุจู ุทุงุฑู", "ูุถูู ุจุงุจ ุงูููุฏุจ", "ูุถูู ูุฑูุฒ", "ูุถูู ุจูุฑููุบ"], answer: "ูุถูู ุจุงุจ ุงูููุฏุจ" }
    ],
    // ุฃุณุฆูุฉ ุงููุฑุญูุฉ ุงูุฑุงุจุนุฉ (ุตุนุจ)
    4: [
        { question: "ูุง ูู ุงุณู ุงูุนุงูู ุงูุฐู ุงูุชุดู ูุงููู ุงูุฌุงุฐุจูุฉุ", options: ["ุฃูุจุฑุช ุฃููุดุชุงูู", "ุฅุณุญุงู ูููุชู", "ุฌุงููููู ุฌุงูููู", "ูููููุง ุชุณูุง"], answer: "ุฅุณุญุงู ูููุชู" },
        { question: "ูุง ูู ุงุณู ุงูุนูููุฉ ุงูุชู ูุชู ูููุง ุชุญููู ุงูุทุงูุฉ ุงูุถูุฆูุฉ ุฅูู ุทุงูุฉ ููููุงุฆูุฉ ูู ุงููุจุงุชุงุชุ", options: ["ุงูุชููุณ ุงูุฎููู", "ุงูุชูุซูู ุงูุถูุฆู", "ุงูุชุฎูุฑ", "ุงูุชุญูู"], answer: "ุงูุชูุซูู ุงูุถูุฆู" },
        { question: "ูุง ูู ุงุณู ุฃุนูู ููุทุฉ ูู ุงููุญูุทุงุชุ", options: ["ุฎูุฏู ุจูุฑุชูุฑููู", "ุฎูุฏู ูุงุฑูุงูุง", "ุฎูุฏู ุณููุฏุง", "ุฎูุฏู ุจูุฑููุบ"], answer: "ุฎูุฏู ูุงุฑูุงูุง" },
        { question: "ูุง ูู ุงุณู ุฃุตุบุฑ ุฏููุฉ ูู ุงูุนุงูู ูู ุญูุซ ุงููุณุงุญุฉุ", options: ["ูููุงูู", "ุงููุงุชููุงู", "ูุงูุฑู", "ุณุงู ูุงุฑููู"], answer: "ุงููุงุชููุงู" },
        { question: "ูุง ูู ุงุณู ุงูุนูููุฉ ุงูุชู ูุชู ูููุง ุงููุณุงู ุงูุฎููุฉ ุฅูู ุฎููุชูู ูุชุทุงุจูุชููุ", options: ["ุงูุงููุณุงู ุงูุงุฎุชุฒุงูู", "ุงูุงููุณุงู ุงููุชุณุงูู", "ุงูุชุจุฑุนู", "ุงูุชุฌุฒุค"], answer: "ุงูุงููุณุงู ุงููุชุณุงูู" }
    ]
};

// ุชุนุฑูู ุฃุณูุงุก ุงููุฑุงุญู
const stageNames = {
    1: "ุงููุฑุญูุฉ ุงูุฃููู - ูุณุชูู ุณูู",
    2: "ุงููุฑุญูุฉ ุงูุซุงููุฉ - ูุณุชูู ูุชูุณุท", 
    3: "ุงููุฑุญูุฉ ุงูุซุงูุซุฉ - ูุณุชูู ูุชูุฏู",
    4: "ุงููุฑุญูุฉ ุงูุฑุงุจุนุฉ - ูุณุชูู ุตุนุจ"
};

// ุฏุงูุฉ ูุจุฏุก ูุฑุญูุฉ ูุนููุฉ
function startStage(stageNum) {
    currentStage = stageNum;         // ุชุญุฏูุซ ุงููุฑุญูุฉ ุงูุญุงููุฉ
    currentQuestionIndex = 0;      // ุฅุนุงุฏุฉ ุชุนููู ููุฑุณ ุงูุณุคุงู
    correctAnswersCount = 0;       // ุฅุนุงุฏุฉ ุชุนููู ุนุฏุฏ ุงูุฅุฌุงุจุงุช ุงูุตุญูุญุฉ
    
    stagesContainer.style.display = 'none'; // ุฅุฎูุงุก ุญุงููุฉ ุงููุฑุงุญู
    quizContainer.style.display = 'block';  // ุฅุธูุงุฑ ุญุงููุฉ ุงูุงุฎุชุจุงุฑ
    resultContainer.style.display = 'none'; // ุฅุฎูุงุก ุญุงููุฉ ุงููุชุงุฆุฌ
    
    quizTitle.textContent = stageNames[stageNum]; // ุชุญุฏูุซ ุนููุงู ุงูุงุฎุชุจุงุฑ ุจุงุณู ุงููุฑุญูุฉ
    
    loadQuestion(); // ุชุญููู ุงูุณุคุงู ุงูุฃูู ูููุฑุญูุฉ
}

// ุฏุงูุฉ ูุชุญููู ุงูุณุคุงู ุงูุญุงูู
function loadQuestion() {
    const stageQuestions = questions[currentStage]; // ุงูุญุตูู ุนูู ุฃุณุฆูุฉ ุงููุฑุญูุฉ ุงูุญุงููุฉ
    
    // ุงูุชุญูู ููุง ุฅุฐุง ูุงูุช ููุงู ุฃุณุฆูุฉ ูุชุจููุฉ ูู ุงููุฑุญูุฉ
    if (currentQuestionIndex < stageQuestions.length) {
        const question = stageQuestions[currentQuestionIndex]; // ุงูุญุตูู ุนูู ุงูุณุคุงู ุงูุญุงูู
        
        // ุชุญุฏูุซ ุนุฏุงุฏ ุงูุฃุณุฆูุฉ (ูุซุงู: 1 / 5)
        questionCounter.textContent = `${currentQuestionIndex + 1} / ${stageQuestions.length}`;
        
        questionText.textContent = question.question; // ุนุฑุถ ูุต ุงูุณุคุงู
        
        optionsContainer.innerHTML = ''; // ูุณุญ ุฎูุงุฑุงุช ุงูุฅุฌุงุจุฉ ุงูุณุงุจูุฉ
        
        // ุฅูุดุงุก ุฃุฒุฑุงุฑ ุฎูุงุฑุงุช ุงูุฅุฌุงุจุฉ ููู ุณุคุงู
        question.options.forEach((option, index) => {
            const button = document.createElement('button'); // ุฅูุดุงุก ุฒุฑ ุฌุฏูุฏ
            button.className = 'option-button';             // ุฅุถุงูุฉ ูุฆุฉ CSS ููุฒุฑ
            button.textContent = option;                     // ุชุนููู ูุต ุงูุฒุฑ (ุฎูุงุฑ ุงูุฅุฌุงุจุฉ)
            // ุฅุถุงูุฉ ูุณุชูุน ุญุฏุซ ุนูุฏ ุงูููุฑ ุนูู ุงูุฒุฑ ูุชุญุฏูุฏ ุงูุฅุฌุงุจุฉ
            button.addEventListener('click', () => selectAnswer(button, option, question.answer));
            optionsContainer.appendChild(button);            // ุฅุถุงูุฉ ุงูุฒุฑ ุฅูู ุญุงููุฉ ุงูุฎูุงุฑุงุช
        });
        
        nextButton.style.display = 'none'; // ุฅุฎูุงุก ุฒุฑ ุงูุชุงูู (ูุฃู ุงูุงูุชูุงู ุฃุตุจุญ ุชููุงุฆููุง)
        feedbackContainer.innerHTML = '';  // ูุณุญ ุฃู ุชุบุฐูุฉ ุฑุงุฌุนุฉ ุณุงุจูุฉ
    } else {
        showResults(); // ุฅุฐุง ุงูุชูุช ุงูุฃุณุฆูุฉุ ุนุฑุถ ุงููุชุงุฆุฌ
    }
}

// ุฏุงูุฉ ูุชุญุฏูุฏ ุงูุฅุฌุงุจุฉ ูุงูุชุญูู ูููุง
function selectAnswer(selectedButton, selectedAnswer, correctAnswer) {
    const allButtons = optionsContainer.querySelectorAll('.option-button'); // ุงูุญุตูู ุนูู ุฌููุน ุฃุฒุฑุงุฑ ุงูุฎูุงุฑุงุช
    // ุชุนุทูู ุฌููุน ุงูุฃุฒุฑุงุฑ ุจุนุฏ ุงุฎุชูุงุฑ ุฅุฌุงุจุฉ ูููุน ุงูููุฑ ุงููุชุนุฏุฏ
    allButtons.forEach(button => {
        button.disabled = true;
        
        // ุชูููุฒ ุงูุฅุฌุงุจุฉ ุงูุตุญูุญุฉ ุจุงูููู ุงูุฃุฎุถุฑ
        if (button.textContent === correctAnswer) {
            button.classList.add('correct');
        // ุชูููุฒ ุงูุฅุฌุงุจุฉ ุงูุฎุงุทุฆุฉ ุงูุชู ุงุฎุชุงุฑูุง ุงููุณุชุฎุฏู ุจุงูููู ุงูุฃุญูุฑ
        } else if (button === selectedButton && selectedAnswer !== correctAnswer) {
            button.classList.add('incorrect');
        }
    });
    
    // ุงูุชุญูู ููุง ุฅุฐุง ูุงูุช ุงูุฅุฌุงุจุฉ ุงููุฎุชุงุฑุฉ ุตุญูุญุฉ
    if (selectedAnswer === correctAnswer) {
        correctAnswersCount++; // ุฒูุงุฏุฉ ุนุฏุงุฏ ุงูุฅุฌุงุจุงุช ุงูุตุญูุญุฉ
        showFeedback('ุฅุฌุงุจุฉ ุตุญูุญุฉ! ๐', 'correct'); // ุนุฑุถ ุฑุณุงูุฉ ุชุบุฐูุฉ ุฑุงุฌุนุฉ ุฅูุฌุงุจูุฉ
    } else {
        showFeedback(`ุฅุฌุงุจุฉ ุฎุงุทุฆุฉ. ุงูุฅุฌุงุจุฉ ุงูุตุญูุญุฉ ูู: ${correctAnswer}`, 'incorrect'); // ุนุฑุถ ุฑุณุงูุฉ ุชุบุฐูุฉ ุฑุงุฌุนุฉ ุณูุจูุฉ
    }
    
    // ุงูุงูุชูุงู ุฅูู ุงูุณุคุงู ุงูุชุงูู ุจุนุฏ 0.5 ุซุงููุฉ (500 ูููู ุซุงููุฉ)
    setTimeout(() => {
        currentQuestionIndex++; // ุฒูุงุฏุฉ ููุฑุณ ุงูุณุคุงู
        loadQuestion();         // ุชุญููู ุงูุณุคุงู ุงูุชุงูู
    }, 500); 
}

// ุฏุงูุฉ ูุนุฑุถ ุฑุณุงูุฉ ุงูุชุบุฐูุฉ ุงูุฑุงุฌุนุฉ (ุตุญูุญ/ุฎุทุฃ)
function showFeedback(message, type) {
    // ุชุญุฏูุซ ูุญุชูู ุญุงููุฉ ุงูุชุบุฐูุฉ ุงูุฑุงุฌุนุฉ ุจุงูุฑุณุงูุฉ ูุงููุฆุฉ ุงูููุงุณุจุฉ
    feedbackContainer.innerHTML = `
        <div class="feedback-message ${type}">
            ${message}
        </div>
    `;
    
    const feedbackElement = feedbackContainer.querySelector('.feedback-message'); // ุงูุญุตูู ุนูู ุนูุตุฑ ุฑุณุงูุฉ ุงูุชุบุฐูุฉ ุงูุฑุงุฌุนุฉ
    // ุชุทุจูู ุฃููุงุท ูุฎุชููุฉ ุจูุงุกู ุนูู ููุน ุงูุชุบุฐูุฉ ุงูุฑุงุฌุนุฉ (ุตุญูุญ/ุฎุทุฃ)
    if (type === 'correct') {
        feedbackElement.style.background = '#d4edda'; // ุฎูููุฉ ุฎุถุฑุงุก ูุงุชุญุฉ
        feedbackElement.style.color = '#155724';     // ูุต ุฃุฎุถุฑ ุฏุงูู
        feedbackElement.style.border = '1px solid #c3e6cb'; // ุญุฏูุฏ ุฎุถุฑุงุก
    } else {
        feedbackElement.style.background = '#f8d7da'; // ุฎูููุฉ ุญูุฑุงุก ูุงุชุญุฉ
        feedbackElement.style.color = '#721c24';     // ูุต ุฃุญูุฑ ุฏุงูู
        feedbackElement.style.border = '1px solid #f5c6cb'; // ุญุฏูุฏ ุญูุฑุงุก
    }
    
    // ุฃููุงุท ุฅุถุงููุฉ ููุชุบุฐูุฉ ุงูุฑุงุฌุนุฉ
    feedbackElement.style.padding = '15px';
    feedbackElement.style.borderRadius = '10px';
    feedbackElement.style.marginTop = '20px';
}

// ุฏุงูุฉ ูุนุฑุถ ุดุงุดุฉ ุงููุชุงุฆุฌ ุจุนุฏ ุงูุชูุงุก ุงููุฑุญูุฉ
function showResults() {
    const percentage = (correctAnswersCount / totalQuestions) * 100; // ุญุณุงุจ ุงููุณุจุฉ ุงููุฆููุฉ ููุฅุฌุงุจุงุช ุงูุตุญูุญุฉ
    const passed = correctAnswersCount === totalQuestions;         // ุงูุชุญูู ููุง ุฅุฐุง ูุงู ุงููุณุชุฎุฏู ูุฏ ุงุฌุชุงุฒ ุงููุฑุญูุฉ (5/5)
    
    quizContainer.style.display = 'none';  // ุฅุฎูุงุก ุญุงููุฉ ุงูุงุฎุชุจุงุฑ
    resultContainer.style.display = 'flex'; // ุฅุธูุงุฑ ุญุงููุฉ ุงููุชุงุฆุฌ
    
    // ุนุฑุถ ุฑุณุงูุฉ ุงููุฌุงุญ ุฃู ุงููุดู
    if (passed) {
        resultIcon.textContent = '๐'; // ุฃููููุฉ ุงุญุชูุงููุฉ
        resultTitle.textContent = 'ุชูุงูููุง!'; // ุนููุงู ุงููุฌุงุญ
        resultMessage.innerHTML = `ููุฏ ูุฌุญุช ูู ุงุฌุชูุงุฒ ${stageNames[currentStage]}!`; // ุฑุณุงูุฉ ุงููุฌุงุญ
        
        // ุฅุฐุง ูุงูุช ุงููุฑุญูุฉ ุงูุฑุงุจุนุฉุ ุนุฑุถ ุฑุณุงูุฉ ุฅููุงู ุงููุนุจุฉ ูุงุณู ุงููุทูุฑ
        if (currentStage === 4) {
            resultMessage.innerHTML += '<br><br>๐ ููุฏ ุฃูููุช ุฌููุน ุงููุฑุงุญู! ๐<br>ุงูุชุธุฑ ุงูุชุญุฏูุซุงุช ูุง ูุญุด!<br><br>โจ ุตูุน ุจูุงุณุทุฉ ุฃุณุงูุฉ โจ';
        }
    } else {
        resultIcon.textContent = '๐'; // ุฃููููุฉ ุญุฒููุฉ
        resultTitle.textContent = 'ุญุงูู ูุฑุฉ ุฃุฎุฑู'; // ุนููุงู ุงููุดู
        resultMessage.textContent = 'ุชุญุชุงุฌ ููุญุตูู ุนูู 5/5 ููุชุญ ุงููุฑุญูุฉ ุงูุชุงููุฉ'; // ุฑุณุงูุฉ ุงููุดู
    }
    
    resultScore.textContent = `${correctAnswersCount} / ${totalQuestions}`; // ุนุฑุถ ุงููุชูุฌุฉ (ูุซุงู: 3 / 5)
    
    // ุฅุฐุง ุงุฌุชุงุฒ ุงููุณุชุฎุฏู ุงููุฑุญูุฉ ููู ุชูู ุงููุฑุญูุฉ ุงูุฃุฎูุฑุฉุ ูุชุญ ุงููุฑุญูุฉ ุงูุชุงููุฉ ูุญูุธ ุงูุชูุฏู
    if (passed && currentStage < 4) {
        unlockNextStage(currentStage + 1); // ูุชุญ ุงููุฑุญูุฉ ุงูุชุงููุฉ
        saveProgress(currentStage + 1);    // ุญูุธ ุงูุชูุฏู
    }
}

// ุฏุงูุฉ ููุชุญ ุงููุฑุญูุฉ ุงูุชุงููุฉ
function unlockNextStage(stageNum) {
    const stageCard = document.getElementById(`stage${stageNum}`);     // ุงูุญุตูู ุนูู ุจุทุงูุฉ ุงููุฑุญูุฉ
    const stageButton = stageCard.querySelector('.stage-button'); // ุงูุญุตูู ุนูู ุฒุฑ ุงููุฑุญูุฉ
    
    stageCard.classList.remove('locked'); // ุฅุฒุงูุฉ ูุฆุฉ 'locked' ูู ุงูุจุทุงูุฉ
    stageButton.disabled = false;         // ุชูุนูู ุฒุฑ ุงููุฑุญูุฉ
    stageButton.innerHTML = '<span>ุงุจุฏุฃ</span>'; // ุชุบููุฑ ูุต ุงูุฒุฑ ุฅูู "ุงุจุฏุฃ"
}

// ุฏุงูุฉ ูุญูุธ ุชูุฏู ุงููุณุชุฎุฏู ูู localStorage
function saveProgress(unlockedStage) {
    localStorage.setItem('unlockedStage', unlockedStage.toString()); // ุญูุธ ุฑูู ุงููุฑุญูุฉ ุงูููุชูุญุฉ
}

// ุฏุงูุฉ ูุชุญููู ุชูุฏู ุงููุณุชุฎุฏู ูู localStorage ุนูุฏ ุชุญููู ุงูุตูุญุฉ
function loadProgress() {
    const savedStage = localStorage.getItem('unlockedStage'); // ุงูุญุตูู ุนูู ุงููุฑุญูุฉ ุงููุญููุธุฉ
    if (savedStage) { // ุฅุฐุง ูุงูุช ููุงู ูุฑุญูุฉ ูุญููุธุฉ
        const unlockedStage = parseInt(savedStage); // ุชุญููู ุงููููุฉ ุฅูู ุนุฏุฏ ุตุญูุญ
        // ูุชุญ ุฌููุน ุงููุฑุงุญู ุญุชู ุงููุฑุญูุฉ ุงููุญููุธุฉ
        for (let i = 2; i <= unlockedStage && i <= 4; i++) {
            unlockNextStage(i);
        }
    }
}

// ุฏุงูุฉ ููุนูุฏุฉ ุฅูู ุดุงุดุฉ ุงููุฑุงุญู
function goBackToStages() {
    stagesContainer.style.display = 'block'; // ุฅุธูุงุฑ ุญุงููุฉ ุงููุฑุงุญู
    quizContainer.style.display = 'none';    // ุฅุฎูุงุก ุญุงููุฉ ุงูุงุฎุชุจุงุฑ
    resultContainer.style.display = 'none';  // ุฅุฎูุงุก ุญุงููุฉ ุงููุชุงุฆุฌ
}

// ุนูุฏ ุชุญููู ูุญุชูู DOM ุจุงููุงูู
document.addEventListener('DOMContentLoaded', function() {
    loadProgress(); // ุชุญููู ุชูุฏู ุงููุณุชุฎุฏู
    
    // ุฅุถุงูุฉ ูุณุชูุนู ุงูุฃุญุฏุงุซ ูุจุทุงูุงุช ุงููุฑุงุญู
    document.querySelectorAll('.stage-card').forEach(card => {
        card.addEventListener('click', function() {
            // ุฅุฐุง ูู ุชูู ุงูุจุทุงูุฉ ูุบููุฉ
            if (!this.classList.contains('locked')) {
                const stageNum = parseInt(this.dataset.stage); // ุงูุญุตูู ุนูู ุฑูู ุงููุฑุญูุฉ ูู data-stage
                startStage(stageNum); // ุจุฏุก ุงููุฑุญูุฉ
            }
        });
    });
    
    // ูุณุชูุน ุญุฏุซ ูุฒุฑ ุงูุชุงูู (ูู ูุนุฏ ูุณุชุฎุฏููุง ุจุดูู ูุจุงุดุฑ ูู ุงูุชุฏูู ุงูุญุงูู)
    nextButton.addEventListener('click', function() {
        currentQuestionIndex++;
        loadQuestion();
    });
    
    // ูุณุชูุน ุญุฏุซ ูุฒุฑ ุงูุนูุฏุฉ
    backButton.addEventListener('click', goBackToStages);
    
    // ูุณุชูุน ุญุฏุซ ูุฒุฑ ุงููุชุงุจุนุฉ ูู ุดุงุดุฉ ุงููุชุงุฆุฌ
    continueButton.addEventListener('click', goBackToStages);
});


